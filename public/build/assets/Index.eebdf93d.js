import{u as C,z as x,o as a,k as E,w as g,a as _,J as m,H,b as t,c as l,f as h,t as i,F as p,h as $,e as F,n as N,l as L,g as O,aa as R,a8 as T}from"./app.f8a8e103.js";import{A as U}from"./UserLayout.9cfe23ff.js";import{o as V,f as q,u as G}from"./useConfirm.635731d4.js";import{_ as K}from"./Loading.0de53e16.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.4b0b489b.js";const Q={class:"py-4"},W={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},X={class:"bg-white overflow-hidden"},Y={class:"p-6 bg-white border-gray-200"},Z={key:0,class:"text-lg font-semibold mb-6"},tt={key:1,class:"mb-8 p-6 bg-blue-50 rounded-lg"},et={class:"flex flex-wrap justify-between md:grid md:grid-cols-3 gap-4"},st=t("p",{class:"text-sm text-blue-600"},"\u30D7\u30E9\u30F3\u540D",-1),ot={class:"font-medium"},it=t("p",{class:"text-sm text-blue-600"},"\u958B\u59CB\u65E5",-1),nt={class:"font-medium"},at=t("p",{class:"text-sm text-blue-600"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),lt={class:"font-medium"},rt={class:"flex flex-wrap items-end justify-between mt-3"},dt={key:0,class:"flex items-center py-2"},ct={class:"flex items-center gap-1"},ut=["src","alt"],mt={class:"font-medium"},bt={class:"text-sm text-gray-500"},ft={class:"text-xs text-gray-500"},vt=["disabled"],_t=t("h3",{class:"text-lg font-semibold mb-6"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),ht={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pt={class:"text-xl font-bold mb-2"},xt={class:"text-gray-600 mb-4"},gt={class:"mb-4"},yt={class:"text-xl font-bold leading-8"},wt=t("span",{class:"text-sm font-normal"},"/\u6708",-1),St={class:"text-green-600 text-sm"},kt={class:"text-rose-500 text-sm leading-7 font-bold"},Ct=["onSubmit"],$t=["disabled"],Ft={class:"py-3 px-1 text-center"},Nt={class:"font-bold text-lg"},jt={class:"text-lg font-bold text-theme mt-1"},Dt=t("span",{class:"text-sm font-normal"},"/\u6708",-1),zt={class:"p-2"},Bt={key:0,class:"text-sm text-gray-500 mb-2"},Lt={key:1,class:"space-y-2"},Vt=["onClick"],At=["id","value"],Mt=["for"],It={class:"flex items-center"},Jt=["src","alt"],Pt={class:"font-medium"},Et={class:"text-sm text-gray-500"},Ht={class:"text-xs text-gray-500"},Ot={key:2,class:"text-gray-500 mb-2"},Rt=t("hr",{class:"my-1"},null,-1),Tt={class:"flex justify-between p-2 gap-2"},Ut=["disabled"],Yt={__name:"Index",props:{plans:Array,currentSubscription:Object,cards:Array},setup(o){const y=o,{confirm:w}=G(),S=C({}),k=x(!1),r=x(""),c=x(null),d=x(!1),b=e=>new Intl.NumberFormat("ja-JP").format(e),A=e=>new Date(e).toLocaleDateString("ja-JP"),j=e=>`/images/credit_cards/${e.toLowerCase()}.svg`,D=e=>e.replace(/(.{4})/g,"$1 ").trim(),z=e=>`${e.slice(0,2)}/${e.slice(2)}`,M=()=>{w("\u89E3\u7D04\u3057\u307E\u3059\u304B\uFF1F","\u89E3\u7D04\u5F8C\u30011\u30F6\u6708\u9593\u767B\u9332\u306F\u3067\u304D\u307E\u305B\u3093\u3002").then(e=>{e&&(d.value=!0,S.post(route("user.subscription.cancel",y.currentSubscription.id),{onFinish:()=>{d.value=!1}}))})},I=()=>{d.value=!0,T.get(route("user.point.card_register",{type:"subscription"})).then(e=>{d.value=!1,e.data.status==1&&(window.location.href=e.data.link_url)}).catch(()=>{d.value=!1})},J=e=>{c.value=e,k.value=!0},f=()=>{k.value=!1,r.value="",c.value=null},P=()=>{c.value&&r.value&&(y.currentSubscription?w("\u30D7\u30E9\u30F3\u3092\u5909\u66F4\u3057\u307E\u3059\u304B\uFF1F",'<div class="text-start space-y-2"><div>\u2022\u3000\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u306E\u5834\u5408\u3001\u73FE\u5728\u306E\u30D7\u30E9\u30F3\u3068\u306E\u5DEE\u984D\u304C\u3059\u3050\u306B\u8ACB\u6C42\u3055\u308C\u3001\u8ACB\u6C42\u65E5\u3082\u672C\u65E5\u306B\u66F4\u65B0\u3055\u308C\u307E\u3059\u3002</div><div>\u2022\u3000\u30C0\u30A6\u30F3\u30B0\u30EC\u30FC\u30C9\u307E\u305F\u306F\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u5909\u66F4\u3059\u308B\u5834\u5408\u3001\u8ACB\u6C42\u65E5\u306F\u5909\u308F\u3089\u305A\u3001\u6B21\u56DE\u306E\u8ACB\u6C42\u6642\u306B\u65B0\u3057\u3044\u30D7\u30E9\u30F3\u306E\u6599\u91D1\u304C\u9069\u7528\u3055\u308C\u307E\u3059\u3002</div></div>').then(e=>{e&&(d.value=!0,C({plan_id:c.value.id,card_id:r.value}).post(route("user.subscription.update",y.currentSubscription.id),{onFinish:()=>{d.value=!1,f()},preserveScroll:!0}))}):w("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u306B\u767B\u9332\u3057\u307E\u3059\u304B\uFF1F").then(e=>{e&&(d.value=!0,C({card_id:r.value}).post(route("user.subscription.subscribe",c.value.id),{onFinish:()=>{d.value=!1,f()},preserveScroll:!0}))}))};return(e,u)=>(a(),E(U,null,{default:g(()=>[_(m(H),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),_(K,{show:d.value,message:"\u51E6\u7406\u4E2D..."},null,8,["show","message"]),t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[o.currentSubscription?(a(),l("h3",Z,"\u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3")):h("",!0),o.currentSubscription?(a(),l("div",tt,[t("div",et,[t("div",null,[st,t("p",ot,i(o.currentSubscription.plan.name),1)]),t("div",null,[it,t("p",nt,i(A(o.currentSubscription.start_date)),1)]),t("div",null,[at,t("p",lt,i(b(o.currentSubscription.plan.point))+" pt",1)])]),t("div",rt,[(a(!0),l(p,null,$(o.cards,s=>(a(),l(p,null,[o.currentSubscription.card_id===s.id?(a(),l("div",dt,[t("div",ct,[t("img",{src:j(s.brand),alt:s.brand,class:"w-20 h-12 mr-2"},null,8,ut),t("div",null,[t("p",mt,i(D(s.card_no)),1),t("p",bt,"\u6709\u52B9\u671F\u9650: "+i(z(s.expire)),1),t("p",ft,"\u540D\u7FA9\u4EBA: "+i(s.holder_name),1)])])])):h("",!0)],64))),256)),t("form",{onSubmit:u[0]||(u[0]=F(s=>M(),["prevent"])),class:"mt-4"},[t("button",{type:"submit",class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm",disabled:m(S).processing}," \u89E3\u7D04 ",8,vt)],32)])])):h("",!0),_t,t("div",ht,[(a(!0),l(p,null,$(o.plans,s=>{var v;return a(),l("div",{key:s.id,class:N(["border rounded-lg p-6",{"bg-yellow-50 border-yellow-500 border-2":((v=o.currentSubscription)==null?void 0:v.plan_id)===s.id}])},[t("h4",pt,i(s.name),1),t("p",xt,i(s.description),1),t("div",gt,[t("p",yt,[L("\xA5"+i(b(s.amount)),1),wt]),t("p",St,i(b(s.point))+" \u30DD\u30A4\u30F3\u30C8\u4ED8\u4E0E",1),t("p",kt,i(b(s.point-s.amount))+" pt\u304A\u5F97!!",1)]),t("div",null,[t("form",{onSubmit:F(n=>J(s),["prevent"])},[t("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-4 rounded text-sm",disabled:m(S).processing},i(o.currentSubscription?o.currentSubscription.plan_id!=s.id?"\u30D7\u30E9\u30F3\u5909\u66F4":"\u30AB\u30FC\u30C9\u5909\u66F4":"\u30B5\u30D6\u30B9\u30AF\u30E9\u30A4\u30D6"),9,$t)],40,Ct)])],2)}),128))])])])])]),_(m(q),{show:k.value,class:""},{default:g(()=>[_(m(V),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:g(()=>{var s,v;return[t("div",{class:"fixed inset-0 z-40",onClick:f},[t("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:u[2]||(u[2]=F(()=>{},["stop"]))},[t("div",Ft,[t("div",Nt,i((s=c.value)==null?void 0:s.name),1),t("div",jt,[L("\xA5 "+i(b((v=c.value)==null?void 0:v.amount)),1),Dt])]),t("div",zt,[o.cards.length>0?(a(),l("div",Bt,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):h("",!0),o.cards.length>0?(a(),l("div",Lt,[(a(!0),l(p,null,$(o.cards,n=>(a(),l(p,{key:n.id},[!o.currentSubscription||c.value&&c.value.id!=o.currentSubscription.plan_id||n.id!=o.currentSubscription.card_id?(a(),l("div",{key:0,class:N([{"border-yellow-500 bg-yellow-50 border-2":r.value===n.id,"hover:bg-gray-50 hover:border-gray-300":r.value!==n.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:B=>r.value=n.id},[O(t("input",{type:"radio",id:"card-"+n.id,value:n.id,"onUpdate:modelValue":u[1]||(u[1]=B=>r.value=B),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,At),[[R,r.value]]),t("label",{for:"card-"+n.id,class:"flex-1 cursor-pointer"},[t("div",It,[t("img",{src:j(n.brand),alt:n.brand,class:"w-20 h-12 mr-2"},null,8,Jt),t("div",null,[t("p",Pt,i(D(n.card_no)),1),t("p",Et,"\u6709\u52B9\u671F\u9650: "+i(z(n.expire)),1),t("p",Ht,"\u540D\u7FA9\u4EBA: "+i(n.holder_name),1)])])],8,Mt)],10,Vt)):h("",!0)],64))),128))])):(a(),l("div",Ot," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),Rt,t("button",{onClick:I,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),t("div",Tt,[t("button",{onClick:f,class:"bg-gray-300 text-gray-700 flex-1 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),t("button",{onClick:P,class:N(["bg-theme text-white flex-1 py-2 rounded text-sm",{"opacity-50":!r.value}]),disabled:!r.value}," \u78BA\u8A8D ",10,Ut)])])])]}),_:1}),_(m(V),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:g(()=>[t("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:f})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{Yt as default};
