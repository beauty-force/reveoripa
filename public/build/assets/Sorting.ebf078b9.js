import{o as r,c as i,b as s,H as I,L as M,u as x,r as c,a as d,w as b,F as v,n as f,l as w,e as g,h as B,t as u,f as m}from"./app.ebf36d57.js";import{A as H}from"./Admin.6b810625.js";import{V as D,r as S,a as V}from"./ArrowLongUpIcon.02f64190.js";import{_ as j}from"./_plugin-vue_export-helper.cdc0426e.js";import"./useConfirm.bc830b17.js";function F(e,t){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})])}const N={components:{Head:I,AppLayout:H,Link:M,draggable:D,ArrowLongUpIcon:S,ArrowLongDownIcon:V,PaperAirplaneIcon:F},props:{errors:Object,auth:Object,gachas:Object,category_share:Object,shuffle_mode:Boolean},data(){return{enabled:!0,list:this.gachas.data.map(e=>({...e,fixed:e.order_level>1e6})),dragging:!1}},methods:{log(e){this.refresh_list()},refresh_list(){this.list=[...this.list.filter(e=>e.fixed),...this.list.filter(e=>!e.fixed)],this.$nextTick(()=>{this.initializeLazyLoading()})},levelUp(e){let t;for(t=1;t<this.list.length&&this.list[t].id!=e;t++);t<this.list.length&&this.arrayMove(t,t-1),this.refresh_list()},arrayMove(e,t){this.list.splice(t,0,this.list.splice(e,1)[0]),this.refresh_list()},levelDown(e){let t;for(t=0;t<this.list.length-1&&this.list[t].id!=e;t++);t<this.list.length-1&&this.arrayMove(t,t+1),this.refresh_list()},submit(){this.form.gachas=this.list,this.form.post(route("admin.gacha.sorting.store"),{onFinish:()=>{}})},shuffle(){this.list=this.list.map(e=>({value:e,sort:Math.random()})).sort((e,t)=>e.sort-t.sort).map(({value:e})=>e),this.refresh_list()},toggle_shuffle(e){this.form_shuffle_mode.shuffle_mode=e,this.form_shuffle_mode.post(route("admin.gacha.shuffle_mode"),{onFinish:()=>{}})},toggle_fix(e){let t;for(t=0;t<this.list.length;t++)if(this.list[t].id==e){this.list[t].fixed^=!0;break}this.refresh_list()},initializeLazyLoading(){const e=document.querySelectorAll("img._lazy"),t={root:null,rootMargin:"0px",threshold:.1},h=n=>{n.src=n.dataset.src},a=new IntersectionObserver((n,l)=>{n.forEach(_=>{_.isIntersecting&&(h(_.target),l.unobserve(_.target))})},t);e.forEach(n=>{a.observe(n)})}},setup(e){const t=x({gachas:[]}),h=x({shuffle_mode:e.shuffle_mode});return{form:t,form_shuffle_mode:h}},mounted(){this.initializeLazyLoading()}},O={class:"mt-2 px-2 md:px-6"},U={class:"p-2 justify-end flex gap-3 items-center mb-2"},P=["disabled"],E=["disabled"],T=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),q=["disabled"],G={class:"flex mb-4"},J={class:"flex items-center gap-4"},K=["data-src"],Q={class:"flex-1"},R={class:"text-neutral-900 text-sm md:text-base font-semibold mb-1"},W={class:"space-y-0.5"},X={class:"flex items-center"},Y={key:0,class:"text-emerald-600 text-xs"},Z={key:1,class:"text-neutral-600 text-xs"},$={class:"text-neutral-700 text-xs md:text-sm"},tt={key:0},et={key:1},st={key:2,class:"text-rose-600 ml-2"},ot={class:"text-neutral-700 text-xs md:text-sm"},rt={class:"flex items-center gap-1"},it=["onClick"],nt={key:0,class:"h-4 w-4",viewBox:"0 0 1024 1024",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},lt=s("path",{d:"M726.646154 466.707692h-9.846154L649.846154 155.569231h17.723077c31.507692 0 57.107692-25.6 57.107692-57.107693s-25.6-57.107692-57.107692-57.107692H356.430769c-31.507692 0-57.107692 25.6-57.107692 57.107692s25.6 57.107692 57.107692 57.107693h17.723077l-64.984615 311.138461h-9.846154c-31.507692 0-57.107692 25.6-57.107692 57.107693s25.6 57.107692 57.107692 57.107692h165.415385v342.646154c0 31.507692 25.6 59.076923 59.076923 59.076923s59.076923-25.6 59.076923-59.076923V582.892308H728.615385c31.507692 0 57.107692-25.6 57.107692-57.107693s-27.569231-59.076923-59.076923-59.076923z"},null,-1),at=[lt],ct={key:1,class:"h-4 w-4",viewBox:"-150 -150 1324 1324",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},dt=s("path",{d:"M974.769231 303.261538L708.923077 37.415385c-27.569231-27.569231-70.892308-27.569231-98.461539 0s-27.569231 70.892308 0 98.461538l13.784616 13.784615-319.015385 210.707693-9.846154-9.846154c-27.569231-27.569231-70.892308-27.569231-98.461538 0s-27.569231 70.892308 0 98.461538l141.784615 141.784616L47.261538 882.215385c-27.569231 27.569231-27.569231 72.861538 0 100.430769 27.569231 27.569231 72.861538 27.569231 100.43077 0L439.138462 689.230769l124.061538 124.061539c27.569231 27.569231 70.892308 27.569231 98.461538 0s27.569231-70.892308 0-98.461539l-9.846153-9.846154 208.738461-320.984615 13.784616 13.784615c27.569231 27.569231 70.892308 27.569231 98.461538 0 27.569231-23.630769 27.569231-66.953846 1.969231-94.523077z"},null,-1),ht=[dt],_t=["onClick"],ft=["onClick"];function ut(e,t,h,a,n,l){const _=c("Head"),y=c("PaperAirplaneIcon"),L=c("ArrowLongUpIcon"),k=c("ArrowLongDownIcon"),C=c("draggable"),A=c("AppLayout");return r(),i(v,null,[d(_,{title:"\u30AC\u30C1\u30E3\u4E26\u3073\u66FF\u3048"}),d(A,null,{default:b(()=>[s("div",O,[s("div",U,[h.shuffle_mode?(r(),i("button",{key:1,type:"button",onClick:t[1]||(t[1]=o=>l.toggle_shuffle(0)),class:f([{"opacity-50":a.form_shuffle_mode.processing},"inline-flex items-center px-4 h-9 bg-neutral-600 text-white text-sm font-medium rounded hover:bg-neutral-700 transition-colors"]),disabled:a.form_shuffle_mode.processing},[T,w(" \u30E9\u30F3\u30C0\u30E0\u8A2D\u5B9A\u89E3\u9664 ")],10,E)):(r(),i("button",{key:0,type:"button",onClick:t[0]||(t[0]=o=>l.toggle_shuffle(1)),class:f([{"opacity-50":a.form_shuffle_mode.processing},"inline-flex items-center px-4 h-9 bg-emerald-500 text-white text-sm font-medium rounded hover:bg-emerald-600 transition-colors"]),disabled:a.form_shuffle_mode.processing}," \u30E9\u30F3\u30C0\u30E0\u8A2D\u5B9A ",10,P)),s("button",{onClick:t[2]||(t[2]=g(o=>l.submit(),["prevent"])),class:f([{"opacity-50":a.form.processing},"inline-flex items-center px-4 h-9 bg-cyan-600 text-white text-sm font-medium rounded hover:bg-cyan-700 transition-colors"]),disabled:a.form.processing},[d(y,{class:"w-4 h-4 mr-2"}),w(" \u4FDD\u5B58 ")],10,q)]),s("div",G,[d(C,{class:"dragArea list-group w-full",list:n.list,onChange:l.log},{default:b(()=>[(r(!0),i(v,null,B(n.list,(o,z)=>(r(),i("div",{class:f(["list-group-item m-0 p-2 rounded text-left cursor-move relative border-b border-neutral-700",{"border-l-4 border-b-1 border-emerald-600 bg-neutral-50":o.fixed}]),key:z},[s("div",J,[s("img",{"data-src":o.thumbnail,class:"w-20 md:w-32 h-15 md:h-24 object-contain rounded _lazy"},null,8,K),s("div",Q,[s("div",R,u(o.title),1),s("div",W,[s("div",X,[o.status==1?(r(),i("span",Y,"\u516C\u958B")):m("",!0),o.status==0?(r(),i("span",Z,"\u975E\u516C\u958B")):m("",!0)]),s("div",$,[o.count_card>0?(r(),i("span",tt,"\u6B8B: "+u(o.count_rest.toLocaleString())+"/"+u(o.count_card.toLocaleString()),1)):(r(),i("span",et,"\u6B8B: - / -")),o.count_rest==0?(r(),i("span",st,"Soldout")):m("",!0)]),s("div",ot,[s("span",null,"1\u56DE: "+u(o.point.toLocaleString())+" PT",1)])])]),s("div",rt,[s("button",{onClick:p=>l.toggle_fix(o.id),class:f(["p-1.5 rounded transition-colors",{"text-neutral-600 bg-neutral-200 hover:bg-neutral-300":!o.fixed,"text-white bg-rose-600 hover:bg-rose-500":o.fixed}])},[o.fixed?(r(),i("svg",nt,at)):(r(),i("svg",ct,ht))],10,it),s("button",{onClick:g(p=>l.levelUp(o.id),["prevent"]),class:"p-1.5 rounded bg-neutral-200 hover:bg-neutral-300 transition-colors text-neutral-600"},[d(L,{class:"w-4 h-4"})],8,_t),s("button",{onClick:g(p=>l.levelDown(o.id),["prevent"]),class:"p-1.5 rounded bg-neutral-200 hover:bg-neutral-300 transition-colors text-neutral-600"},[d(k,{class:"w-4 h-4"})],8,ft)])])],2))),128))]),_:1},8,["list","onChange"])])])]),_:1})],64)}const vt=j(N,[["render",ut]]);export{vt as default};
