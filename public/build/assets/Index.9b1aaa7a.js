import{H,L as E,u as V,r as _,o as a,c,a as h,w as x,F as f,b as t,h as k,n as p,g as b,a3 as w,t as l,f as u,a0 as D,l as m}from"./app.2d685c1b.js";import{A as O}from"./UserLayout.c37edf78.js";import{P as T}from"./ProductTabBar.f6562cd6.js";import{P as F}from"./PageHeader.64f17802.js";import{u as N}from"./useConfirm.13051242.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";import"./index.8386b6b2.js";const{confirm:C,alert:v}=N(),U={components:{Head:H,AppLayout:O,Link:E,ProductTabBar:T,ProductHeader:F},props:{errors:Object,gacha:Object,category_share:Object,products:Object,profile:Object,delivery_limit:Number},data(){return{hasCheck:!1,main_tab:[{title:"\u672A\u9078\u629E",route_url:route("user.products"),is_active:!0},{title:"\u767A\u9001\u5F85\u3061",route_url:route("user.products.wait"),is_active:!1},{title:"\u767A\u9001\u6E08\u307F",route_url:route("user.products.delivered"),is_active:!1}],ready_delivery:0,products_count:0,isCheckAll:!1,isProductListExpanded:!1,_products:this.products.data.filter(o=>o.status==1),sortBy:"point_desc"}},computed:{sortedProducts(){const o=[...this.products.data];switch(this.sortBy){case"point_asc":return o.sort((e,i)=>e.point-i.point);case"point_desc":return o.sort((e,i)=>i.point-e.point);case"updated_at_asc":return o.sort((e,i)=>new Date(e.updated_at)-new Date(i.updated_at));case"updated_at_desc":return o.sort((e,i)=>new Date(i.updated_at)-new Date(e.updated_at));default:return o}}},setup(o){return{form:V({checks:{}})}},methods:{format_number(o){return String(o).replace(/(.)(?=(\d{3})+$)/g,"$1,")},changeCheck(){let o,e=!1;for(this._products=this.products.data.filter(i=>i.status==1),this.isCheckAll=this._products.length>0,o=0;o<this._products.length;o++)this.form.checks["id"+this._products[o].id]?e=!0:this.isCheckAll=!1;this.hasCheck=e},submit(o){let e,i=0;var n=0;let r=0;for(e=0;e<this._products.length;e++)this.form.checks["id"+this._products[e].id]&&(i++,n=parseInt(n)+parseInt(this._products[e].point),this._products[e].rare=="\u30DD\u30A4\u30F3\u30C8"&&r++);if(o=="point")n>0&&C("\u4EA4\u63DB\u3057\u307E\u3059\u304B\uFF1F \u9078\u629E\u3057\u305F"+i+"\u70B9\u306E\u5546\u54C1\u3092"+this.format_number(n)+"pt\u3068\u4EA4\u63DB\u3057\u307E\u3059\u3002").then(d=>{d&&this.form.post(route("user.products.point.exchange"),{onFinish:()=>{this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})});else{if(r>0){v("\u30DD\u30A4\u30F3\u30C8\u306F\u767A\u9001\u3067\u304D\u307E\u305B\u3093");return}if(i>0){if(n<this.delivery_limit){v("\u767A\u9001\u4F9D\u983C\u304C\u3067\u304D\u308B\u6700\u4F4E\u30DD\u30A4\u30F3\u30C8\u306F"+this.format_number(this.delivery_limit)+"pt\u3067\u3059\u3002");return}this.products_count=i,this.ready_delivery=1}}},back_delivery(){this.ready_delivery=0},submit_delivery(){this.profile.city&&this.profile.street?C(""+this.products_count+"\u70B9\u306E\u5546\u54C1\u3092\u914D\u9001\u3057\u307E\u3059\u304B\uFF1F").then(o=>{o&&this.form.post(route("user.delivery.post"),{onFinish:()=>{this.ready_delivery=2,this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})}):v("\u5165\u529B\u30A8\u30E9\u30FC\u3001\u914D\u9001\u5148\u60C5\u5831\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002")},checkall(){let o;for(this.hasCheck=!1,o=0;o<this._products.length;o++)this.form.checks["id"+this._products[o].id]=this.isCheckAll,this.hasCheck=this.isCheckAll},toggleProductList(){this.isProductListExpanded=!this.isProductListExpanded}}},I={key:0,class:"p-3 md:p-4 w-full"},M={class:"grid md:grid-cols-2 gap-3 md:gap-4 mt-2 md:mt-4"},z={class:"bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-200"},R=["id","onUpdate:modelValue"],q=["for"],G={class:"relative"},J=["src"],K={class:"min-h-28 ml-4 flex flex-col justify-evenly flex-1"},Q={key:0,class:"text-base font-bold text-slate-800"},W={key:1,class:"text-base font-bold text-slate-800"},X={class:"text-sm text-slate-700"},Y={class:"text-sm text-slate-500"},Z={key:2,class:"flex bg-gradient-to-r from-slate-600 to-slate-700 justify-center items-center rounded-full px-4 py-1 text-white w-fit"},$=t("img",{src:"/images/icon_cash.png?v=3",class:"h-4 mr-1"},null,-1),tt={class:"text-xs text-slate-400"},et={class:"sticky bottom-[74px] md:bottom-[82px] bg-white py-4 space-y-4 mt-8 border-t border-slate-200 -mx-3 md:-mx-4"},st={class:"text-center"},ot={class:"flex items-center cursor-pointer justify-center"},it=t("span",{class:"ml-2 font-bold text-slate-600"},"\u5168\u3066\u3092\u9078\u629E\u3059\u308B",-1),rt={class:"text-center text-slate-600 flex justify-center items-center gap-4 text-sm"},lt=["disabled"],nt=["disabled"],dt={key:1,class:"p-4 md:p-6"},at=t("h2",{class:"my-2 text-base md:text-lg font-bold text-slate-800"},"\u914D\u9001\u5185\u5BB9\u306E\u78BA\u8A8D",-1),ct={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6 space-y-4"},ut={class:"flex items-center justify-between"},ht={class:"text-sm font-medium text-slate-700"},mt=t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),_t=[mt],ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pt={key:0,class:"flex items-center p-4 bg-slate-50 rounded-xl"},xt=["src"],bt={class:"ml-4 flex-1"},vt={class:"text-sm font-bold text-slate-800"},yt={class:"text-sm font-medium text-slate-800"},gt={class:"text-sm text-slate-500"},kt={class:"text-sm text-slate-600"},wt={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6"},Ct=t("div",{class:"mb-4 text-sm font-medium text-slate-700"},"\u914D\u9001\u5148\u60C5\u5831",-1),Pt={class:"flex items-center justify-between"},jt={class:"flex-1 space-y-1"},Lt={class:"text-sm text-slate-600"},Bt={class:"text-sm text-slate-600"},At={class:"text-sm text-slate-600"},Ht={class:"font-medium text-slate-800"},Et={class:"flex justify-center gap-4"},Vt={key:2,class:"max-w-2xl mx-auto p-6"},Dt=t("h2",{class:"mb-6 text-base md:text-lg text-center font-bold text-slate-800"},"\u914D\u9001\u624B\u7D9A\u304D\u5B8C\u4E86",-1),Ot={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6"},Tt={class:"text-center text-slate-600 mb-4"},Ft=t("br",null,null,-1),Nt=t("br",null,null,-1),St=t("span",{class:"font-bold"},"\u6570\u65E5~\u6570\u9031\u9593",-1),Ut=t("br",null,null,-1),It={class:"flex justify-center gap-4"};function Mt(o,e,i,n,r,d){const P=_("Head"),j=_("ProductHeader"),L=_("ProductTabBar"),y=_("Link"),B=_("AppLayout");return a(),c(f,null,[h(P,{title:"\u7372\u5F97\u3057\u305F\u5546\u54C1\u4E00\u89A7"}),h(B,null,{default:x(()=>[h(j,{title:"\u7372\u5F97\u3057\u305F\u5546\u54C1\u4E00\u89A7",class:"mt-3"}),r.ready_delivery==0?(a(),c("div",I,[h(L,{tabs:r.main_tab,sortBy:r.sortBy,"onUpdate:sortBy":e[0]||(e[0]=s=>r.sortBy=s)},null,8,["tabs","sortBy"]),t("div",M,[(a(!0),c(f,null,k(d.sortedProducts,(s,A)=>(a(),c("div",z,[t("div",{class:p(["flex items-start w-full p-3 md:p-4 gap-2",{"bg-slate-50":n.form.checks["id"+s.id]}])},[b(t("input",{id:"checkbox"+s.id,"onUpdate:modelValue":g=>n.form.checks["id"+s.id]=g,type:"checkbox",onChange:e[1]||(e[1]=g=>d.changeCheck()),class:"cursor-pointer rounded border-slate-300 text-slate-600 shadow-sm focus:ring-0 m-1"},null,40,R),[[w,n.form.checks["id"+s.id]]]),t("label",{for:"checkbox"+s.id,class:"flex-1 cursor-pointer flex items-center text-sm"},[t("div",G,[t("img",{src:s.image,class:"h-28 object-contain"},null,8,J)]),t("div",K,[s.gacha_title?(a(),c("div",Q,l(s.gacha_title),1)):u("",!0),s.gacha_id==0?(a(),c("div",W,"RP\u30D7\u30ED\u30C0\u30AF\u30C8")):u("",!0),t("div",X,l(s.name),1),t("div",Y,l(s.rare),1),s.is_lost_product!=2?(a(),c("div",Z,[$,t("span",null,l(s.point.toLocaleString())+"\xA0PT",1)])):u("",!0),t("div",tt,"\u4FDD\u6709\u671F\u9650: "+l(s.expiration),1)])],8,q)],2)]))),256))]),t("div",et,[t("div",st,[t("label",ot,[b(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>r.isCheckAll=s),onChange:e[3]||(e[3]=s=>d.checkall()),class:"h-5 w-5 cursor-pointer rounded border-slate-300 text-slate-600 focus:ring-0"},null,544),[[w,r.isCheckAll]]),it])]),t("div",rt,[t("button",{type:"button",onClick:e[4]||(e[4]=s=>d.submit("point")),class:p([{"opacity-50":n.form.processing||!r.hasCheck},"w-40 md:w-60 inline-flex items-center justify-center px-4 py-2 md:py-3 rounded-xl font-semibold text-sm text-neutral-700 bg-yellow-300 hover:bg-yellow-400 transition-all duration-200"]),disabled:n.form.processing||!r.hasCheck}," \u30DD\u30A4\u30F3\u30C8\u306B\u63DB\u3048\u308B ",10,lt),t("button",{type:"button",onClick:e[5]||(e[5]=s=>d.submit("delivery")),class:p([{"opacity-50":n.form.processing||!r.hasCheck},"w-40 md:w-60 inline-flex items-center justify-center px-4 py-2 md:py-3 rounded-xl font-semibold text-sm text-white bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 transition-all duration-200 shadow-sm hover:shadow-md"]),disabled:n.form.processing||!r.hasCheck}," \u767A\u9001\u3059\u308B ",10,nt)])])])):u("",!0),r.ready_delivery==1?(a(),c("div",dt,[at,t("div",ct,[t("div",ut,[t("div",ht,"\u914D\u9001\u5546\u54C1 \uFF08\u8A08"+l(r.products_count)+"\u70B9\uFF09",1),t("button",{onClick:e[6]||(e[6]=(...s)=>d.toggleProductList&&d.toggleProductList(...s)),class:"text-sm text-slate-600 hover:text-slate-800 flex items-center gap-1"},[t("span",null,l(r.isProductListExpanded?"\u9589\u3058\u308B":"\u5C55\u958B\u3059\u308B"),1),(a(),c("svg",{xmlns:"http://www.w3.org/2000/svg",class:p(["h-4 w-4 transition-transform",{"rotate-180":r.isProductListExpanded}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},_t,2))])]),b(t("div",ft,[(a(!0),c(f,null,k(d.sortedProducts,(s,A)=>(a(),c(f,null,[n.form.checks["id"+s.id]?(a(),c("div",pt,[t("img",{src:s.image,class:"h-20 w-20 object-contain"},null,8,xt),t("div",bt,[t("div",vt,l(s.gacha_title),1),t("div",yt,l(s.name),1),t("div",gt,l(s.rare),1),t("div",kt,l(s.point)+"pt",1)])])):u("",!0)],64))),256))],512),[[D,r.isProductListExpanded]])]),t("div",wt,[Ct,t("div",Pt,[t("div",jt,[i.profile.id?(a(),c(f,{key:0},[t("p",Lt,"\u3012"+l(i.profile.postal_code),1),t("p",Bt,l(i.profile.city)+l(i.profile.street),1),t("p",At,l(i.profile.building),1),t("p",Ht,l(i.profile.first_name+i.profile.last_name),1)],64)):u("",!0)]),t("div",null,[h(y,{href:o.route("user.address"),type:"button",onClick:e[7]||(e[7]=s=>d.back_delivery()),class:"inline-flex items-center px-4 py-2 rounded-lg font-medium text-sm text-slate-600 bg-slate-50 hover:bg-slate-100 transition-colors"},{default:x(()=>[m(" \u7DE8\u96C6 ")]),_:1},8,["href"])])])]),t("div",Et,[t("button",{type:"button",onClick:e[8]||(e[8]=s=>d.back_delivery()),class:"w-32 inline-flex items-center justify-center px-4 py-3 rounded-xl font-medium text-sm text-slate-700 bg-slate-100 hover:bg-slate-200 transition-colors"}," \u623B\u308B "),t("button",{type:"button",onClick:e[9]||(e[9]=s=>d.submit_delivery()),class:"w-32 inline-flex items-center justify-center px-4 py-3 rounded-xl font-medium text-sm text-white bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 transition-all duration-200 shadow-sm hover:shadow-md"}," \u767A\u9001\u3059\u308B ")])])):u("",!0),r.ready_delivery==2?(a(),c("div",Vt,[Dt,t("div",Ot,[t("div",Tt,[m(" \u8A08"+l(r.products_count)+"\u70B9\u306E\u5546\u54C1\u306E\u914D\u9001\u624B\u7D9A\u304D\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F\u3002",1),Ft,Nt,m(" \u5546\u54C1\u306E\u767A\u9001\u306B\u306F"),St,m("\u304B\u304B\u308B\u53EF\u80FD\u6027\u304C\u3054\u3056\u3044\u307E\u3059\u3002"),Ut,m(" \u3054\u4E86\u627F\u306E\u307B\u3069\u3088\u308D\u3057\u304F\u304A\u9858\u3044\u81F4\u3057\u307E\u3059\u3002 ")])]),t("div",It,[h(y,{href:o.route("main"),class:"w-48 inline-flex items-center justify-center px-4 py-3 rounded-xl font-medium text-sm text-white bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 transition-all duration-200 shadow-sm hover:shadow-md"},{default:x(()=>[m(" \u30AC\u30C1\u30E3TOP\u3078 ")]),_:1},8,["href"]),t("button",{type:"button",onClick:e[10]||(e[10]=s=>d.back_delivery()),class:"w-48 inline-flex items-center justify-center px-4 py-3 rounded-xl font-medium text-sm text-white bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 transition-all duration-200 shadow-sm hover:shadow-md"}," \u7372\u5F97\u3057\u305F\u5546\u54C1\u4E00\u89A7\u3078 ")])])):u("",!0)]),_:1})],64)}const Wt=S(U,[["render",Mt]]);export{Wt as default};
