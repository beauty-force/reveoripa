import{p as O,q as j,L as B,j as w,d as G,r as m,o as a,c as o,b as e,a as h,w as x,n as b,F as z,l as v,f as r,t as c,_ as F}from"./app.81247923.js";import{G as q}from"./GachaButtons.64a718ff.js";import{u as A}from"./useConfirm.8a6715aa.js";import{_ as H}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as R}from"./PlayIcon.274271c4.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const f=1e3,_=60*f,g=60*_,M=24*g,k="abort",S="end",E="progress",C="start",I="visibilitychange";var U=O({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:s=>s>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:s=>s>=0},transform:{type:Function,default:s=>s}},emits:[k,S,E,C],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/M)},hours(){return Math.floor(this.totalMilliseconds%M/g)},minutes(){return Math.floor(this.totalMilliseconds%g/_)},seconds(){return Math.floor(this.totalMilliseconds%_/f)},milliseconds(){return Math.floor(this.totalMilliseconds%f)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/g)},totalMinutes(){return Math.floor(this.totalMilliseconds/_)},totalSeconds(){return Math.floor(this.totalMilliseconds/f)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(I,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(I,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(C),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const s=Math.min(this.totalMilliseconds,this.interval);if(s>0){let i,t;const u=n=>{i||(i=n),t||(t=n);const l=n-i;l>=s||l+(n-t)/2>=s?this.progress():this.requestId=requestAnimationFrame(u),t=n};this.requestId=requestAnimationFrame(u)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){!this.counting||(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(E,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(k))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(S))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return j(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const{confirm:P}=A(),Y={components:{Link:B,PlayIcon:R,VueCountdown:U,GachaButtons:q},props:{gacha:Object,url_edit:String,openCopyModal:Function},data(){return{category_share:w().props.value.category_share,url_card:"",url_10gacha:"",url_1gacha:"",str_gacha10:"",point_10gacha:0,countdown:!0,user:w().props.value.auth.user}},computed:{progress_width(){return this.gacha.count_card>0?Math.round(this.gacha.count_rest*100/this.gacha.count_card)+"%":"100%"},progress_color(){let s=this.gacha.count_card>0?Math.round(this.gacha.count_rest*100/this.gacha.count_card):100;return s>=50?"bg-green-500":s>=20?"bg-yellow-500":"bg-rose-500"}},methods:{format_number(s){return String(s).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getImageClass(s){return"url('"+s+"')"},clickCard(){this.url_edit||(window.location.href=this.url_card)},destroyGacha(s){P("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F","","error").then(i=>{i&&G.Inertia.delete(route("admin.gacha.destroy",s))})},transform(s){return Object.entries(s).forEach(([i,t])=>{const u=t<10&&i!="days"?`0${t}`:t;t<2&&i.replace(/s$/,""),s[i]=`${u}`}),s}},mounted(){this.gacha.count_rest<10?(this.str_gacha10="\u5168\u3066",this.point_10gacha=this.gacha.count_rest*this.gacha.point):(this.str_gacha10="10\u9023",this.point_10gacha=10*this.gacha.point),this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix)}},J={class:"h-full flex flex-col rounded-lg overflow-hidden relative"},K=["data-src"],Q={key:0,class:"absolute z-10 top-2 left-2 items-center px-3 py-1.5 bg-green-500/90 border border-green-400/50 rounded-full font-semibold text-sm text-white tracking-widest shadow-lg"},W={key:1,class:"absolute z-10 top-2 left-2 items-center px-3 py-1.5 bg-neutral-500/90 border border-neutral-400/50 rounded-full font-semibold text-sm text-white tracking-widest shadow-lg"},X={class:"absolute z-10 top-2 right-2 flex flex-col gap-2"},Z={key:1,class:"absolute w-full h-full z-10 flex flex-col justify-center items-center gap-8"},$={class:"text-white text-5xl w-full bg-neutral-900/90 text-center font-black pb-2 font-[mplus2]"},tt={key:2,class:"absolute bottom-0 w-full h-full bg-opacity-80 z-[5] bg-neutral-900 flex items-center justify-center"},et=e("div",{class:"text-white text-[30px] text-center font-bold px-8 py-4 bg-yellow-500/90 rounded-xl shadow-lg"},"\u73FE\u5728\u56DE\u305B\u307E\u305B\u3093",-1),st=[et],it={key:3,class:"absolute bottom-0 w-full h-full bg-opacity-80 z-10 bg-neutral-900 flex flex-col justify-center items-center gap-4"},at=e("div",{class:"text-white text-xl w-full text-center font-black"},"\u30E9\u30F3\u30AF\u5236\u9650",-1),ot=e("div",{class:"text-white text-sm w-full text-center font-black"},null,-1),nt=[at,ot],lt={class:"w-full flex flex-col justify-center flex-1 max-h-20"},rt={class:"font-[mplus2]"},ct={class:"flex justify-between items-end py-1.5 w-full"},dt={class:"flex items-end gap-1.5 w-[45%] px-3"},ut=e("img",{src:"/images/icon_cash.png",class:"h-5 mb-1"},null,-1),ht={class:"text-base md:text-xl font-bold"},ft=e("span",{class:"text-xs pb-0.5 text-nowrap"},"/1\u56DE",-1),_t={class:"flex-1 flex flex-col items-end gap-1.5 pr-2"},gt={key:0,class:"text-xs pr-1"},mt={key:1,class:"flex items-center"},xt=e("span",{class:"font-semibold pr-2"},"- / -",-1),bt=[xt],yt={class:"w-full px-2 pb-1"},pt={class:"w-full h-2 rounded-full overflow-hidden flex bg-neutral-300/50"},wt={key:4,class:"flex items-center"},vt={class:"w-full flex justify-around items-center gap-1 text-neutral-700"},Mt={key:0,class:"text-sm tracking-wider"},kt={key:1,class:"text-sm tracking-wider"},St={class:"flex items-center bg-gradient-to-r from-rose-500 to-purple-500 bg-clip-text text-transparent font-extrabold text-xl font-[mplus2]"},Et={key:0,class:"pr-2"},Ct={class:""},It=e("span",{class:"text-lg"},":",-1),Nt={class:""},Tt=e("span",{class:"text-lg"},":",-1),Lt={class:""},Dt={key:5,class:"px-1 py-1 flex items-end"};function Vt(s,i,t,u,n,l){var p;const y=m("Link"),N=m("vue-countdown"),T=m("GachaButtons");return a(),o("div",{class:b(["cursor-pointer w-full overflow-hidden border rounded-xl shadow-[0_4px_12px_0px_rgba(0,0,0,0.2)] p-1.5 bg-white",{"cursor-pointer hover:shadow-[0_8px_16px_4px_rgba(0,0,0,0.2)] transition-all duration-300":!t.url_edit&&t.gacha.count_rest&&t.gacha.timeStatus==1,"grayscale-[60%] pointer-events-none":!t.url_edit&&(t.gacha.count_rest==0||t.gacha.timeStatus!=1)}])},[e("div",J,[h(y,{href:n.url_card,class:b(["relative flex-1",{"grayscale-[80%]":t.url_edit&&t.gacha.count_rest==0}])},{default:x(()=>[e("img",{"data-src":t.gacha.thumbnail,class:"lazy w-full h-full object-cover"},null,8,K)]),_:1},8,["href","class"]),t.url_edit?(a(),o(z,{key:0},[t.gacha.status==1?(a(),o("div",Q," \u516C\u958B ")):(a(),o("div",W," \u975E\u516C\u958B ")),e("div",X,[h(y,{href:t.url_edit,class:"items-center px-6 py-2 bg-green-500/90 border border-green-400/50 rounded-full font-semibold text-sm text-white uppercase tracking-widest hover:bg-green-600 active:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-300 shadow-lg"},{default:x(()=>[v(" \u7DE8\u96C6\u3059\u308B ")]),_:1},8,["href"]),e("button",{onClick:i[0]||(i[0]=d=>t.openCopyModal(t.gacha.id)),class:"px-4 py-2 bg-sky-500/90 border border-sky-400/50 rounded-full hover:bg-sky-600 text-sm text-white shadow-lg transition-all duration-300"}," \u30B3\u30D4\u30FC "),e("button",{onClick:i[1]||(i[1]=d=>l.destroyGacha(t.gacha.id)),class:"px-4 py-2 bg-red-500/90 border border-red-400/50 rounded-full hover:bg-red-600 text-sm text-white shadow-lg transition-all duration-300"}," \u524A\u9664 ")])],64)):r("",!0),t.gacha.count_rest==0&&!t.url_edit?(a(),o("div",Z,[e("div",$,[v(" SOLD OUT "),n.user&&n.user.type==1?(a(),o("button",{key:0,class:"text-base font-normal text-white border border-neutral-300 w-fit rounded-full min-w-[40%] px-5 py-1.5 hover:bg-white hover:text-black transition-all duration-300",onClick:i[2]||(i[2]=d=>l.clickCard())},"\u6392\u51FA\u5C65\u6B74")):r("",!0)])])):r("",!0),t.url_edit&&t.gacha.count_rest!=t.gacha.ableCount?(a(),o("div",tt,st)):r("",!0),t.gacha.rank_limit>((p=n.user)==null?void 0:p.current_rank)&&!t.url_edit?(a(),o("div",it,nt)):r("",!0),e("div",lt,[e("div",rt,[e("div",ct,[e("div",dt,[ut,e("span",ht,c(l.format_number(t.gacha.point)),1),ft]),e("div",_t,[t.gacha.count_card>0?(a(),o("span",gt," \u306E\u3053\u308A "+c(l.format_number(t.gacha.count_rest))+" / "+c(l.format_number(t.gacha.count_card)),1)):(a(),o("div",mt,bt))])]),e("div",yt,[e("div",pt,[e("div",{class:b(`h-full rounded-full border-neutral-800 transition-all duration-500 ${l.progress_color}`),style:F({width:l.progress_width})},null,6)])])])]),n.countdown&&t.gacha.remaining>0&&t.gacha.count_rest>0?(a(),o("div",wt,[h(N,{time:t.gacha.remaining*1e3,transform:l.transform,class:"text-gray-100 flex items-center justify-around px-2 py-1 w-full font-semibold",onEnd:i[3]||(i[3]=d=>n.countdown=!1)},{default:x(({days:d,hours:L,minutes:D,seconds:V})=>[e("div",vt,[t.gacha.timeStatus==0?(a(),o("span",Mt,"\u767A\u58F2\u307E\u3067")):r("",!0),t.gacha.timeStatus==1?(a(),o("span",kt,"\u7D42\u4E86\u307E\u3067")):r("",!0),e("div",St,[d>0?(a(),o("span",Et,c(d)+"\u65E5",1)):r("",!0),e("span",Ct,c(L),1),It,e("span",Nt,c(D),1),Tt,e("span",Lt,c(V),1)])])]),_:1},8,["time","transform"])])):r("",!0),t.url_edit?r("",!0):(a(),o("div",Dt,[h(T,{gacha:t.gacha},null,8,["gacha"])]))])],2)}const Ft=H(Y,[["render",Vt]]);export{Ft as G};
